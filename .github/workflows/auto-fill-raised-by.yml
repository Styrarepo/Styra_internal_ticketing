name: Auto-fill Raised By (Author)
on:
  issues:
    types: [opened]
jobs:
  set-raised-by:
    runs-on: ubuntu-latest
    steps:
      - name: Set Raised By from Issue Author
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const projectId = "O_kgDODrspUQ";
            const fieldId = "256585926";

            const author = context.payload.issue.user.login;
            const itemId = context.payload.issue.node_id;

            await github.graphql(`
              mutation($project: ID!, $item: ID!, $field: ID!, $value: String!) {
                updateProjectV2ItemFieldValue(
                  input: {
                    projectId: $project
                    itemId: $item
                    fieldId: $field
                    value: { text: $value }
                  }
                ) {
                  projectV2Item {
                    id
                  }
                }
              }
            `, {
              project: projectId,
              item: itemId,
              field: fieldId,
              value: author
            });

            console.log(`Raised By set to ${author}`);
